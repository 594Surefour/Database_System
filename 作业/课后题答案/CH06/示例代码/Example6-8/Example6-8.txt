delimiter $$
create procedure banktransfer_proc(in withdraw int, in deposit int, in money int, out state int)
modifies sql data
begin
declare continue handler for 1264
begin  
  rollback;
  set state=-1;
end;
set state=1;
start transaction;
update account set value=value+money where accountno=deposit;
update account set value=value-money where accountno=withdraw;
commit;
end
$$
delimiter ;
